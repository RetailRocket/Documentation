---
description: >-
  В документе описывают общение принципы которых придерживаются API разных
  продуктов Retail Rocket
---

# Общие принципы интеграции с Retail Rocket

## Основные принципы

Все API Retail Rocket доступны по протоколу HTTP/2.

Если для вызова метода требуется передача данных в теле запроса, то система ожидает их в формате JSON и соответствующего http-заголовка: `content-type: application/json`

Все данные, которые возвращаются в результате вызова, возвращаются в формате JSON.

Статусы HTTP-ответа имеют значение. Возможные статусы метода описываются в его документации.

## **Идентификатор интернет-магазина**

Для идентификации интернет-магазина в API используется параметр`partnerId`.  Значение параметра выдается при регистрации в системе Retail Rocket и может быть получено либо запросом к аккаунт-менеджеру Retail Rocket, либо обращением в службу поддержки \(support@retailrocket.ru\), либо в [личном кабинете Retail Rocket](https://my.retailrocket.ru).

{% hint style="info" %}
Значение является **публичным** и может быть использовано в открытом виде.
{% endhint %}

## Авторизация

Доступ к некоторым методам API ограничен, и для их использования требуется передавать параметр `apiKey`, значение которого можно получить у сотрудника Retail Rocket.

{% hint style="danger" %}
Значение `apiKey` является **секретным** и не должно передаваться третьим лицам.
{% endhint %}

{% hint style="danger" %}
Значение `apiKey` не должно передаваться или храниться на клиентской стороне \(на сайте или в мобильном приложении\).
{% endhint %}

{% hint style="warning" %}
В случае утечки значения `apiKey`следует запросить у аккаунт-менеджера новое. Старое значение перестанет действовать.
{% endhint %}

{% hint style="info" %}
**Рекомендация**

Хранить значение `apiKey` в хранилище, в котором его можно изменить без необходимости выпускать новую версию сайта/приложения.
{% endhint %}

## **Управление сессией**

Для некоторых вызовов API требуется идентифицировать посетителя, для которого этот запрос применим. Для этого требуется передавать идентификатор пользовательской сессии в параметре `sessionExternalId.` Идентификатор должен быть сгенерирован на стороне магазина и обладать следующими свойствами:

* Состоять только из цифр и букв;
* Не превышать 50 символов;
* Быть уникальным для устройства/браузера;
* Не содержать персональных данных, например, телефона или адреса электронной почты;
* Не должен изменяться при авторизации или смене аккаунта.

{% hint style="info" %}
**Рекомендация**

При первом появлении посетителя на сайте или в мобильном приложении генерировать GUID и использовать его в качестве `sessionExternalId` для последующих вызовов API.
{% endhint %}

## Метка времени вызова

Для корректной работы многих продуктов Retail Rocket необходимо знать время, когда метод был вызван, для этого в некоторых методах API предусмотрен опциональный параметр `timestamp`, в значении которого система Retail Rocket ожидает дату и время в формате ISO 8601.

Если опциональный параметр не задан, то в качестве временной метки будет использовано серверное время Retail Rocket на момент вызова.

## Товарная база

Товарная база необходима для обработки пользовательского поведения в интернет-магазине. Способы передачи товарной базы: 

* **YML-файл** - XML-файл в формате YML
* **Onsite tracking** - Передача товарной базы через трекинг-код на веб-сайте интернет-магазина.

## Сведения о товаре

Если в методе API требуются товарные данные \(например, идентификатор товара/склада и т.д.\), значение таких параметров должно совпадать со значениями, переданными с товарной базой в Retail Rocket.

### Поддержка региональности \(склад/регион\)

Функционал региональности позволяет передавать информацию о товарах \(например: цену и наличие\), актуальную для конкретного склада/региона. Это позволяет везде, где используются данные товара, опираться на данные для конкретного склада или региона. 

Данные, которые могут быть переопределены для конкретного склада:

* Цена;
* Старая цена;
* Признак наличия товара;
* Название товара;
* Описание товара;
* Ссылка на товар;
* Ссылка на изображение;



